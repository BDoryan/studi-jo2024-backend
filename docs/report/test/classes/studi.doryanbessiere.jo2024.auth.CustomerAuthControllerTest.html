<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta http-equiv="x-ua-compatible" content="IE=edge"/>
<title>Test results - CustomerAuthControllerTest</title>
<link href="../css/base-style.css" rel="stylesheet" type="text/css"/>
<link href="../css/style.css" rel="stylesheet" type="text/css"/>
<script src="../js/report.js" type="text/javascript"></script>
</head>
<body>
<div id="content">
<h1>CustomerAuthControllerTest</h1>
<div class="breadcrumbs">
<a href="../index.html">all</a> &gt; 
<a href="../packages/studi.doryanbessiere.jo2024.auth.html">studi.doryanbessiere.jo2024.auth</a> &gt; CustomerAuthControllerTest</div>
<div id="summary">
<table>
<tr>
<td>
<div class="summaryGroup">
<table>
<tr>
<td>
<div class="infoBox" id="tests">
<div class="counter">9</div>
<p>tests</p>
</div>
</td>
<td>
<div class="infoBox" id="failures">
<div class="counter">0</div>
<p>failures</p>
</div>
</td>
<td>
<div class="infoBox" id="ignored">
<div class="counter">0</div>
<p>ignored</p>
</div>
</td>
<td>
<div class="infoBox" id="duration">
<div class="counter">0.790s</div>
<p>duration</p>
</div>
</td>
</tr>
</table>
</div>
</td>
<td>
<div class="infoBox success" id="successRate">
<div class="percent">100%</div>
<p>successful</p>
</div>
</td>
</tr>
</table>
</div>
<div class="tab-container">
<ul class="tabLinks">
<li>
<a href="#">Tests</a>
</li>
<li>
<a href="#">Standard output</a>
</li>
<li>
<a href="#">Standard error</a>
</li>
</ul>
<div class="tab">
<h2>Tests</h2>
<table>
<thead>
<tr>
<th>Test</th>
<th>Duration</th>
<th>Result</th>
</tr>
</thead>
<tr>
<td class="success">shouldCreateCustomerSuccessfully()</td>
<td class="success">0.084s</td>
<td class="success">passed</td>
</tr>
<tr>
<td class="success">shouldLoginSuccessfullyWithTwoFactorValidation()</td>
<td class="success">0.178s</td>
<td class="success">passed</td>
</tr>
<tr>
<td class="success">shouldRegisterCustomerSuccessfully()</td>
<td class="success">0.327s</td>
<td class="success">passed</td>
</tr>
<tr>
<td class="success">shouldRejectEmptyFields()</td>
<td class="success">0.009s</td>
<td class="success">passed</td>
</tr>
<tr>
<td class="success">shouldRejectLoginWithEmptyFields()</td>
<td class="success">0.013s</td>
<td class="success">passed</td>
</tr>
<tr>
<td class="success">shouldRejectLoginWithUnknownEmail()</td>
<td class="success">0.010s</td>
<td class="success">passed</td>
</tr>
<tr>
<td class="success">shouldRejectLoginWithWrongPassword()</td>
<td class="success">0.126s</td>
<td class="success">passed</td>
</tr>
<tr>
<td class="success">shouldRejectNonMatchingPasswords()</td>
<td class="success">0.016s</td>
<td class="success">passed</td>
</tr>
<tr>
<td class="success">shouldRejectWeakPassword()</td>
<td class="success">0.027s</td>
<td class="success">passed</td>
</tr>
</table>
</div>
<div class="tab">
<h2>Standard output</h2>
<span class="code">
<pre>01:43:15.922 [Test worker] INFO org.springframework.test.context.support.AnnotationConfigContextLoaderUtils -- Could not detect default configuration classes for test class [studi.doryanbessiere.jo2024.auth.CustomerAuthControllerTest]: CustomerAuthControllerTest does not declare any static, non-private, non-final, nested classes annotated with @Configuration.
01:43:16.003 [Test worker] INFO org.springframework.boot.test.context.SpringBootTestContextBootstrapper -- Found @SpringBootConfiguration studi.doryanbessiere.jo2024.Jo2024Application for test class studi.doryanbessiere.jo2024.auth.CustomerAuthControllerTest

  .   ____          _            __ _ _
 /\\ / ___'_ __ _ _(_)_ __  __ _ \ \ \ \
( ( )\___ | '_ | '_| | '_ \/ _` | \ \ \ \
 \\/  ___)| |_)| | | | | || (_| |  ) ) ) )
  '  |____| .__|_| |_|_| |_\__, | / / / /
 =========|_|==============|___/=/_/_/_/

 :: Spring Boot ::                (v3.3.3)

2025-10-21T01:43:16.402+02:00  INFO 195064 --- [    Test worker] s.d.j.auth.CustomerAuthControllerTest    : Starting CustomerAuthControllerTest using Java 21.0.8 with PID 195064 (started by doryanbessiere in /home/doryanbessiere/Bureau/Studi/Projets/jo2024)
2025-10-21T01:43:16.404+02:00  INFO 195064 --- [    Test worker] s.d.j.auth.CustomerAuthControllerTest    : The following 1 profile is active: &quot;test&quot;
2025-10-21T01:43:17.021+02:00  INFO 195064 --- [    Test worker] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-10-21T01:43:17.067+02:00  INFO 195064 --- [    Test worker] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 41 ms. Found 6 JPA repository interfaces.
2025-10-21T01:43:18.266+02:00  INFO 195064 --- [    Test worker] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port 0 (http)
2025-10-21T01:43:18.282+02:00  INFO 195064 --- [    Test worker] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2025-10-21T01:43:18.282+02:00  INFO 195064 --- [    Test worker] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.28]
2025-10-21T01:43:18.328+02:00  INFO 195064 --- [    Test worker] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2025-10-21T01:43:18.329+02:00  INFO 195064 --- [    Test worker] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 1907 ms
2025-10-21T01:43:18.497+02:00  INFO 195064 --- [    Test worker] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2025-10-21T01:43:18.534+02:00  INFO 195064 --- [    Test worker] org.hibernate.Version                    : HHH000412: Hibernate ORM core version 6.5.2.Final
2025-10-21T01:43:18.556+02:00  INFO 195064 --- [    Test worker] o.h.c.internal.RegionFactoryInitiator    : HHH000026: Second-level cache disabled
2025-10-21T01:43:18.625+02:00  INFO 195064 --- [    Test worker] o.s.o.j.p.SpringPersistenceUnitInfo      : No LoadTimeWeaver setup: ignoring JPA class transformer
2025-10-21T01:43:18.641+02:00  INFO 195064 --- [    Test worker] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2025-10-21T01:43:18.752+02:00  INFO 195064 --- [    Test worker] com.zaxxer.hikari.pool.HikariPool        : HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:testdb user=SA
2025-10-21T01:43:18.756+02:00  INFO 195064 --- [    Test worker] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2025-10-21T01:43:18.777+02:00  WARN 195064 --- [    Test worker] org.hibernate.orm.deprecation            : HHH90000025: H2Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-10-21T01:43:19.337+02:00  INFO 195064 --- [    Test worker] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
Hibernate: drop table if exists admins cascade 
Hibernate: drop table if exists customers cascade 
Hibernate: drop table if exists offers cascade 
Hibernate: drop table if exists tickets cascade 
Hibernate: drop table if exists transactions cascade 
Hibernate: drop table if exists two_factor_tokens cascade 
Hibernate: create table admins (id bigint generated by default as identity, email varchar(255) not null unique, full_name varchar(255), password varchar(255) not null, role varchar(255), primary key (id))
Hibernate: create table customers (id bigint generated by default as identity, email varchar(255) not null unique, first_name varchar(255), last_name varchar(255), password varchar(255) not null, reset_expire_token varchar(255), secret_key varchar(255) not null unique, primary key (id))
Hibernate: create table offers (active BOOLEAN DEFAULT TRUE not null, persons integer not null, price float(53) not null, quantity integer not null, id bigint generated by default as identity, description TEXT not null, name varchar(255) not null unique, primary key (id))
Hibernate: create table tickets (entries_allowed integer not null, created_at timestamp(6) with time zone not null, id bigint generated by default as identity, transaction_id bigint not null, customer_secret varchar(64) not null, secret_key varchar(64) not null unique, status enum ('ACTIVE','USED') not null, primary key (id))
Hibernate: create table transactions (amount float(53) not null, created_at timestamp(6) with time zone, customer_id bigint not null, id bigint generated by default as identity, offer_id bigint not null, offer_name varchar(255) not null, stripe_session_id varchar(255), status enum ('FAILED','PAID','PENDING'), primary key (id))
Hibernate: create table two_factor_tokens (consumed boolean not null, created_at timestamp(6) not null, expires_at timestamp(6) not null, code varchar(255) not null, email varchar(255) not null, id varchar(255) not null, type enum ('ADMIN','CUSTOMER') not null, primary key (id))
Hibernate: alter table if exists tickets add constraint FK7p6l8ys9u9wpvvtafgcagw7h3 foreign key (transaction_id) references transactions
Hibernate: alter table if exists transactions add constraint FKpnnreq9lpejqyjfct60v7n7x1 foreign key (customer_id) references customers
2025-10-21T01:43:19.377+02:00  INFO 195064 --- [    Test worker] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-10-21T01:43:19.938+02:00  WARN 195064 --- [    Test worker] JpaBaseConfiguration$JpaWebConfiguration : spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-10-21T01:43:20.572+02:00  INFO 195064 --- [    Test worker] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring TestDispatcherServlet ''
2025-10-21T01:43:20.572+02:00  INFO 195064 --- [    Test worker] o.s.t.web.servlet.TestDispatcherServlet  : Initializing Servlet ''
2025-10-21T01:43:20.573+02:00  INFO 195064 --- [    Test worker] o.s.t.web.servlet.TestDispatcherServlet  : Completed initialization in 1 ms
2025-10-21T01:43:20.605+02:00  INFO 195064 --- [    Test worker] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port 41549 (http) with context path '/'
2025-10-21T01:43:20.612+02:00  INFO 195064 --- [    Test worker] s.d.j.auth.CustomerAuthControllerTest    : Started CustomerAuthControllerTest in 4.51 seconds (process running for 5.211)
Hibernate: select c1_0.id,c1_0.email,c1_0.reset_expire_token,c1_0.first_name,c1_0.last_name,c1_0.password,c1_0.secret_key from customers c1_0
Hibernate: select tft1_0.id,tft1_0.code,tft1_0.consumed,tft1_0.created_at,tft1_0.email,tft1_0.expires_at,tft1_0.type from two_factor_tokens tft1_0
Hibernate: select c1_0.id from customers c1_0 where c1_0.email=? fetch first ? rows only
Hibernate: insert into customers (email,reset_expire_token,first_name,last_name,password,secret_key,id) values (?,?,?,?,?,?,default)
2025-10-21T01:43:20.915+02:00  INFO 195064 --- [    Test worker] s.d.j.s.customers.CustomerAuthService    : Customer registered with email=jean.dupont@example.com

MockHttpServletRequest:
      HTTP Method = POST
      Request URI = /auth/customer/register
       Parameters = {}
          Headers = [Content-Type:&quot;application/json;charset=UTF-8&quot;, Content-Length:&quot;126&quot;]
             Body = {&quot;firstname&quot;:&quot;Jean&quot;,&quot;lastname&quot;:&quot;Dupont&quot;,&quot;email&quot;:&quot;jean.dupont@example.com&quot;,&quot;password&quot;:&quot;Test1234&quot;,&quot;confirm_password&quot;:&quot;Test1234&quot;}
    Session Attrs = {}

Handler:
             Type = studi.doryanbessiere.jo2024.services.customers.CustomerAuthController
           Method = studi.doryanbessiere.jo2024.services.customers.CustomerAuthController#register(RegisterRequest)

Async:
    Async started = false
     Async result = null

Resolved Exception:
             Type = null

ModelAndView:
        View name = null
             View = null
            Model = null

FlashMap:
       Attributes = null

MockHttpServletResponse:
           Status = 200
    Error message = null
          Headers = [Vary:&quot;Origin&quot;, &quot;Access-Control-Request-Method&quot;, &quot;Access-Control-Request-Headers&quot;, Content-Type:&quot;application/json&quot;, X-Content-Type-Options:&quot;nosniff&quot;, X-XSS-Protection:&quot;0&quot;, Cache-Control:&quot;no-cache, no-store, max-age=0, must-revalidate&quot;, Pragma:&quot;no-cache&quot;, Expires:&quot;0&quot;, X-Frame-Options:&quot;DENY&quot;]
     Content type = application/json
             Body = {&quot;status&quot;:&quot;success&quot;,&quot;message&quot;:&quot;customer_registered&quot;}
    Forwarded URL = null
   Redirected URL = null
          Cookies = []
Hibernate: select c1_0.id,c1_0.email,c1_0.reset_expire_token,c1_0.first_name,c1_0.last_name,c1_0.password,c1_0.secret_key from customers c1_0
Hibernate: delete from customers where id=?
Hibernate: select tft1_0.id,tft1_0.code,tft1_0.consumed,tft1_0.created_at,tft1_0.email,tft1_0.expires_at,tft1_0.type from two_factor_tokens tft1_0
Hibernate: select c1_0.id from customers c1_0 where c1_0.email=? fetch first ? rows only
Hibernate: select c1_0.id,c1_0.email,c1_0.reset_expire_token,c1_0.first_name,c1_0.last_name,c1_0.password,c1_0.secret_key from customers c1_0
Hibernate: select tft1_0.id,tft1_0.code,tft1_0.consumed,tft1_0.created_at,tft1_0.email,tft1_0.expires_at,tft1_0.type from two_factor_tokens tft1_0

MockHttpServletRequest:
      HTTP Method = POST
      Request URI = /auth/customer/login
       Parameters = {}
          Headers = [Content-Type:&quot;application/json;charset=UTF-8&quot;, Content-Length:&quot;26&quot;]
             Body = {&quot;password&quot;:&quot;&quot;,&quot;email&quot;:&quot;&quot;}
    Session Attrs = {}

Handler:
             Type = studi.doryanbessiere.jo2024.services.customers.CustomerAuthController
           Method = studi.doryanbessiere.jo2024.services.customers.CustomerAuthController#login(LoginRequest)

Async:
    Async started = false
     Async result = null

Resolved Exception:
             Type = org.springframework.web.bind.MethodArgumentNotValidException

ModelAndView:
        View name = null
             View = null
            Model = null

FlashMap:
       Attributes = null

MockHttpServletResponse:
           Status = 400
    Error message = null
          Headers = [Vary:&quot;Origin&quot;, &quot;Access-Control-Request-Method&quot;, &quot;Access-Control-Request-Headers&quot;, Content-Type:&quot;application/json&quot;, X-Content-Type-Options:&quot;nosniff&quot;, X-XSS-Protection:&quot;0&quot;, Cache-Control:&quot;no-cache, no-store, max-age=0, must-revalidate&quot;, Pragma:&quot;no-cache&quot;, Expires:&quot;0&quot;, X-Frame-Options:&quot;DENY&quot;]
     Content type = application/json
             Body = {&quot;message&quot;:&quot;validation_failed&quot;,&quot;errors&quot;:{&quot;password&quot;:&quot;is_required&quot;,&quot;email&quot;:&quot;is_required&quot;},&quot;status&quot;:&quot;error&quot;,&quot;timestamp&quot;:&quot;2025-10-21T01:43:20.987686706+02:00&quot;}
    Forwarded URL = null
   Redirected URL = null
          Cookies = []
Hibernate: select c1_0.id,c1_0.email,c1_0.reset_expire_token,c1_0.first_name,c1_0.last_name,c1_0.password,c1_0.secret_key from customers c1_0
Hibernate: select tft1_0.id,tft1_0.code,tft1_0.consumed,tft1_0.created_at,tft1_0.email,tft1_0.expires_at,tft1_0.type from two_factor_tokens tft1_0
Hibernate: insert into customers (email,reset_expire_token,first_name,last_name,password,secret_key,id) values (?,?,?,?,?,?,default)
2025-10-21T01:43:21.055+02:00  INFO 195064 --- [    Test worker] s.d.j.s.customers.CustomerAuthService    : Customer registered with email=camille@example.com
Hibernate: select c1_0.id,c1_0.email,c1_0.reset_expire_token,c1_0.first_name,c1_0.last_name,c1_0.password,c1_0.secret_key from customers c1_0 where c1_0.email=?
2025-10-21T01:43:21.114+02:00  WARN 195064 --- [    Test worker] s.d.j.s.customers.CustomerAuthService    : Invalid password provided for email=camille@example.com

MockHttpServletRequest:
      HTTP Method = POST
      Request URI = /auth/customer/login
       Parameters = {}
          Headers = [Content-Type:&quot;application/json;charset=UTF-8&quot;, Content-Length:&quot;58&quot;]
             Body = {&quot;password&quot;:&quot;WrongPassword&quot;,&quot;email&quot;:&quot;camille@example.com&quot;}
    Session Attrs = {}

Handler:
             Type = studi.doryanbessiere.jo2024.services.customers.CustomerAuthController
           Method = studi.doryanbessiere.jo2024.services.customers.CustomerAuthController#login(LoginRequest)

Async:
    Async started = false
     Async result = null

Resolved Exception:
             Type = studi.doryanbessiere.jo2024.common.exceptions.InvalidCredentialsException

ModelAndView:
        View name = null
             View = null
            Model = null

FlashMap:
       Attributes = null

MockHttpServletResponse:
           Status = 401
    Error message = null
          Headers = [Vary:&quot;Origin&quot;, &quot;Access-Control-Request-Method&quot;, &quot;Access-Control-Request-Headers&quot;, Content-Type:&quot;application/json&quot;, X-Content-Type-Options:&quot;nosniff&quot;, X-XSS-Protection:&quot;0&quot;, Cache-Control:&quot;no-cache, no-store, max-age=0, must-revalidate&quot;, Pragma:&quot;no-cache&quot;, Expires:&quot;0&quot;, X-Frame-Options:&quot;DENY&quot;]
     Content type = application/json
             Body = {&quot;message&quot;:&quot;invalid_credentials&quot;,&quot;code&quot;:&quot;invalid_credentials&quot;,&quot;status&quot;:&quot;error&quot;}
    Forwarded URL = null
   Redirected URL = null
          Cookies = []
Hibernate: select c1_0.id,c1_0.email,c1_0.reset_expire_token,c1_0.first_name,c1_0.last_name,c1_0.password,c1_0.secret_key from customers c1_0
Hibernate: delete from customers where id=?
Hibernate: select tft1_0.id,tft1_0.code,tft1_0.consumed,tft1_0.created_at,tft1_0.email,tft1_0.expires_at,tft1_0.type from two_factor_tokens tft1_0
Hibernate: select c1_0.id,c1_0.email,c1_0.reset_expire_token,c1_0.first_name,c1_0.last_name,c1_0.password,c1_0.secret_key from customers c1_0
Hibernate: select tft1_0.id,tft1_0.code,tft1_0.consumed,tft1_0.created_at,tft1_0.email,tft1_0.expires_at,tft1_0.type from two_factor_tokens tft1_0
Hibernate: select c1_0.id,c1_0.email,c1_0.reset_expire_token,c1_0.first_name,c1_0.last_name,c1_0.password,c1_0.secret_key from customers c1_0 where c1_0.email=?
2025-10-21T01:43:21.136+02:00  WARN 195064 --- [    Test worker] s.d.j.s.customers.CustomerAuthService    : Login attempt with unknown email=unknown@example.com

MockHttpServletRequest:
      HTTP Method = POST
      Request URI = /auth/customer/login
       Parameters = {}
          Headers = [Content-Type:&quot;application/json;charset=UTF-8&quot;, Content-Length:&quot;56&quot;]
             Body = {&quot;password&quot;:&quot;SomePass123&quot;,&quot;email&quot;:&quot;unknown@example.com&quot;}
    Session Attrs = {}

Handler:
             Type = studi.doryanbessiere.jo2024.services.customers.CustomerAuthController
           Method = studi.doryanbessiere.jo2024.services.customers.CustomerAuthController#login(LoginRequest)

Async:
    Async started = false
     Async result = null

Resolved Exception:
             Type = studi.doryanbessiere.jo2024.common.exceptions.InvalidCredentialsException

ModelAndView:
        View name = null
             View = null
            Model = null

FlashMap:
       Attributes = null

MockHttpServletResponse:
           Status = 401
    Error message = null
          Headers = [Vary:&quot;Origin&quot;, &quot;Access-Control-Request-Method&quot;, &quot;Access-Control-Request-Headers&quot;, Content-Type:&quot;application/json&quot;, X-Content-Type-Options:&quot;nosniff&quot;, X-XSS-Protection:&quot;0&quot;, Cache-Control:&quot;no-cache, no-store, max-age=0, must-revalidate&quot;, Pragma:&quot;no-cache&quot;, Expires:&quot;0&quot;, X-Frame-Options:&quot;DENY&quot;]
     Content type = application/json
             Body = {&quot;message&quot;:&quot;invalid_credentials&quot;,&quot;code&quot;:&quot;invalid_credentials&quot;,&quot;status&quot;:&quot;error&quot;}
    Forwarded URL = null
   Redirected URL = null
          Cookies = []
Hibernate: select c1_0.id,c1_0.email,c1_0.reset_expire_token,c1_0.first_name,c1_0.last_name,c1_0.password,c1_0.secret_key from customers c1_0
Hibernate: select tft1_0.id,tft1_0.code,tft1_0.consumed,tft1_0.created_at,tft1_0.email,tft1_0.expires_at,tft1_0.type from two_factor_tokens tft1_0
Hibernate: insert into customers (email,reset_expire_token,first_name,last_name,password,secret_key,id) values (?,?,?,?,?,?,default)
2025-10-21T01:43:21.203+02:00  INFO 195064 --- [    Test worker] s.d.j.s.customers.CustomerAuthService    : Customer registered with email=alice@example.com
Hibernate: select c1_0.id,c1_0.email,c1_0.reset_expire_token,c1_0.first_name,c1_0.last_name,c1_0.password,c1_0.secret_key from customers c1_0 where c1_0.email=?
Hibernate: select c1_0.id,c1_0.email,c1_0.reset_expire_token,c1_0.first_name,c1_0.last_name,c1_0.password,c1_0.secret_key from customers c1_0
Hibernate: delete from customers where id=?
Hibernate: select tft1_0.id,tft1_0.code,tft1_0.consumed,tft1_0.created_at,tft1_0.email,tft1_0.expires_at,tft1_0.type from two_factor_tokens tft1_0
Hibernate: insert into customers (email,reset_expire_token,first_name,last_name,password,secret_key,id) values (?,?,?,?,?,?,default)
2025-10-21T01:43:21.289+02:00  INFO 195064 --- [    Test worker] s.d.j.s.customers.CustomerAuthService    : Customer registered with email=paul@example.com
Hibernate: select c1_0.id,c1_0.email,c1_0.reset_expire_token,c1_0.first_name,c1_0.last_name,c1_0.password,c1_0.secret_key from customers c1_0 where c1_0.email=?
2025-10-21T01:43:21.349+02:00  INFO 195064 --- [    Test worker] s.d.j.s.customers.CustomerAuthService    : Customer authenticated email=paul@example.com
Hibernate: select tft1_0.id,tft1_0.code,tft1_0.consumed,tft1_0.created_at,tft1_0.email,tft1_0.expires_at,tft1_0.type from two_factor_tokens tft1_0 where tft1_0.email=? and tft1_0.type=?
Hibernate: select tft1_0.id,tft1_0.code,tft1_0.consumed,tft1_0.created_at,tft1_0.email,tft1_0.expires_at,tft1_0.type from two_factor_tokens tft1_0 where tft1_0.id=?
2025-10-21T01:43:21.368+02:00  INFO 195064 --- [    Test worker] s.d.j.s.twofactor.TwoFactorAuthService   : 2FA challenge created for email=paul@example.com type=CUSTOMER expiresAt=2025-10-21T01:53:21.354013602
Hibernate: insert into two_factor_tokens (code,consumed,created_at,email,expires_at,type,id) values (?,?,?,?,?,?,?)

MockHttpServletRequest:
      HTTP Method = POST
      Request URI = /auth/customer/login
       Parameters = {}
          Headers = [Content-Type:&quot;application/json;charset=UTF-8&quot;, Content-Length:&quot;50&quot;]
             Body = {&quot;password&quot;:&quot;Test1234&quot;,&quot;email&quot;:&quot;paul@example.com&quot;}
    Session Attrs = {}

Handler:
             Type = studi.doryanbessiere.jo2024.services.customers.CustomerAuthController
           Method = studi.doryanbessiere.jo2024.services.customers.CustomerAuthController#login(LoginRequest)

Async:
    Async started = false
     Async result = null

Resolved Exception:
             Type = null

ModelAndView:
        View name = null
             View = null
            Model = null

FlashMap:
       Attributes = null

MockHttpServletResponse:
           Status = 200
    Error message = null
          Headers = [Vary:&quot;Origin&quot;, &quot;Access-Control-Request-Method&quot;, &quot;Access-Control-Request-Headers&quot;, Content-Type:&quot;application/json&quot;, X-Content-Type-Options:&quot;nosniff&quot;, X-XSS-Protection:&quot;0&quot;, Cache-Control:&quot;no-cache, no-store, max-age=0, must-revalidate&quot;, Pragma:&quot;no-cache&quot;, Expires:&quot;0&quot;, X-Frame-Options:&quot;DENY&quot;]
     Content type = application/json
             Body = {&quot;token&quot;:null,&quot;two_factor_required&quot;:true,&quot;challenge_id&quot;:&quot;be1bf5ab-4228-4bb1-a0d6-92afc3004656&quot;}
    Forwarded URL = null
   Redirected URL = null
          Cookies = []
Hibernate: select tft1_0.id,tft1_0.code,tft1_0.consumed,tft1_0.created_at,tft1_0.email,tft1_0.expires_at,tft1_0.type from two_factor_tokens tft1_0 where tft1_0.id=?
Hibernate: select tft1_0.id,tft1_0.code,tft1_0.consumed,tft1_0.created_at,tft1_0.email,tft1_0.expires_at,tft1_0.type from two_factor_tokens tft1_0 where tft1_0.id=?
2025-10-21T01:43:21.385+02:00  INFO 195064 --- [    Test worker] s.d.j.s.twofactor.TwoFactorAuthService   : 2FA challenge validated for email=paul@example.com type=CUSTOMER
Hibernate: delete from two_factor_tokens where id=?
Hibernate: select c1_0.id,c1_0.email,c1_0.reset_expire_token,c1_0.first_name,c1_0.last_name,c1_0.password,c1_0.secret_key from customers c1_0 where c1_0.email=?
Hibernate: select c1_0.id,c1_0.email,c1_0.reset_expire_token,c1_0.first_name,c1_0.last_name,c1_0.password,c1_0.secret_key from customers c1_0
Hibernate: delete from customers where id=?
Hibernate: select tft1_0.id,tft1_0.code,tft1_0.consumed,tft1_0.created_at,tft1_0.email,tft1_0.expires_at,tft1_0.type from two_factor_tokens tft1_0
Hibernate: select c1_0.id from customers c1_0 where c1_0.email=? fetch first ? rows only
</pre>
</span>
</div>
<div class="tab">
<h2>Standard error</h2>
<span class="code">
<pre>WARNING: A Java agent has been loaded dynamically (/home/doryanbessiere/.gradle/caches/modules-2/files-2.1/net.bytebuddy/byte-buddy-agent/1.14.19/154da3a65b4f4a909d3e5bdec55d1b2b4cbb6ce1/byte-buddy-agent-1.14.19.jar)
WARNING: If a serviceability tool is in use, please run with -XX:+EnableDynamicAgentLoading to hide this warning
WARNING: If a serviceability tool is not in use, please run with -Djdk.instrument.traceUsage for more information
WARNING: Dynamic loading of agents will be disallowed by default in a future release
Aucun mot de passe défini pour ADMIN_DEFAULT_PASSWORD - administrateur non créé.
</pre>
</span>
</div>
</div>
<div id="footer">
<p>
<div>
<label class="hidden" id="label-for-line-wrapping-toggle" for="line-wrapping-toggle">Wrap lines
<input id="line-wrapping-toggle" type="checkbox" autocomplete="off"/>
</label>
</div>Generated by 
<a href="https://www.gradle.org">Gradle 8.14.3</a> at 21 oct. 2025, 01:43:23</p>
</div>
</div>
</body>
</html>
